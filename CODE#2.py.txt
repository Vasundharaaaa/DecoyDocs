import smtplib
from email.mime.text import MIMEText
from datetime import datetime
import socket
import getpass

# Email configuration
SENDER_EMAIL = "DecoyAlerts18@gmail.com"
SENDER_PASSWORD = "your_app_password_here"  # 👈 Replace with Gmail App Password
RECEIVER_EMAIL = "your_personal_email@gmail.com"  # 👈 Replace with your real email

# Collect basic system info
hostname = socket.gethostname()
username = getpass.getuser()
ip_address = socket.gethostbyname(hostname)
timestamp = datetime.now().strftime("%Y-%m-%d %I:%M:%S %p")

# Email content
subject = "🚨 ALERT: AWS Credentials File Opened!"
body = f"""
Unauthorized access detected!

A user has opened the file: AWS_Credentials.txt

📅 Date & Time: {timestamp}
🧑‍💻 Username: {username}
💻 Hostname: {hostname}
🌐 IP Address: {ip_address}

If this was NOT an authorized action, investigate immediately.

This alert was auto-generated by the DecoyDoc system.
"""

msg = MIMEText(body)
msg['Subject'] = subject
msg['From'] = SENDER_EMAIL
msg['To'] = RECEIVER_EMAIL

# Send the email
try:
    with smtplib.SMTP_SSL('smtp.gmail.com', 465) as smtp:
        smtp.login(SENDER_EMAIL, SENDER_PASSWORD)
        smtp.send_message(msg)
    print("✅ Fake alert email sent successfully!")
except Exception as e:
    print("❌ Failed to send email:", e)
